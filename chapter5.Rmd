#Dimensionality Reduction Techniques

In this chapter, we will practice dimensionality reduction techniques using "human" data which was originated from the United Nations Development Programme (UNDP). Additional information about the data can be found [here](http://hdr.undp.org/en/content/human-development-index-hdi).

## RStudio Exercise 5  

**Data Exploration**  

First we will load the data into R and get an overview of it.
```{r, ex1}
human<-read.table("data/human.csv")
#head(human)
dim(human)
str(human)
colnames(human)
```
The subset of the data used in this exercise contain eight variables and 155 observations. Out of the eight variables, **GNI** and **Mat.Mor** are integer variables and the rest of the six variables are all numerical. In the following table, you may see what kind of information all these variables are telling or storing in the data frame.

Variables | Description
-----------|---------------------------------------------------------------------------
Edu2.FM | ratio of females and males with at least secondary education
Labo.FM | ratio of females and males in labour force
Edu.Exp | expected years of schooling
Life.Exp | life expectancy at birth
GNI | gross national income per capita
Mat.Mor | maternal mortality ratio
Ado.Birth | adolescent birth rate
Parli.F| percentage of female representatives in parliament

**Data Summary**  
As in earlier exercises, we will proceed with data summary. Let's first take a look at the summary of the data.
``` {r, ex2.1}
library(pander)
pandoc.table(summary(human), caption = "Summary of Human data", split.table = 80)
```

```{r, fig.width=10, fig.height=10, ex2.2}
library(GGally)
library(ggplot2)
ggpairs(human, mapping = aes(alpha = 0.3), lower = list(combo = wrap("facethist")))


```

**Principal Component Analysis**  

Perform principal component analysis (PCA) on the not standardized human data. Show the variability captured by the principal components. Draw a biplot displaying the observations by the first two principal components (PC1 coordinate in x-axis, PC2 coordinate in y-axis), along with arrows representing the original variables. (0-2 points)
```{r, ex3, fig.height=11, fig.width=11}
pca_human<-prcomp(human)
sum_pca_human<-summary(pca_human)
sum_pca_human
sum_pca_human_var<-sum_pca_human$sdev^2
sum_pca_human_var
pca_pr <- round(100*sum_pca_human$importance[2, ], digits = 1)
pc_lab<-paste0(names(pca_pr), " (", pca_pr, "%)")

biplot(pca_human, cex = c(0.8, 1), col = c("grey40", "deeppink2"), xlab = pc_lab[1], ylab = pc_lab[2])


#biplot(pca_human, choices = 1:2, cex = c(1, 1), col = c("grey40", "deeppink2"),sub = "PC1 & PC2 with non-standardised dataset")

```


**Data Standardization**  

Standardize the variables in the human data and repeat the above analysis. Interpret the results of both analysis (with and without standardizing). Are the results different? Why or why not? Include captions in you plots where you describe the results by using not just your variable names, but the actual phenomenons they relate to. (0-4 points)
```{r, ex4, fig.height=10, fig.width=10}

pca_human_s<-prcomp(human, scale. = TRUE)
sum_pca_human_s<-summary(pca_human_s)
pca_pr_s <- round(100*sum_pca_human_s$importance[2, ], digits = 1)
pc_lab<-paste0(names(pca_pr_s), " (", pca_pr_s, "%)")

sum_pca_human_var_s<-sum_pca_human_s$sdev^2
sum_pca_human_var_s

biplot(pca_human_s, cex = c(0.8, 1), col = c("grey40", "deeppink2"), xlab = pc_lab[1], ylab = pc_lab[2])

```

**Personal Interpretation on Biplot**  

Give your personal interpretations of the first two principal component dimensions based on the biplot drawn after PCA on the standardized human data. (0-2 points)

**Multiple Correspondence Analysis**  

Load the tea dataset from the package Factominer. Explore the data briefly: look at the structure and the dimensions of the data and visualize it. Then do Multiple Correspondence Analysis on the tea data (or to a certain columns of the data, itâ€™s up to you). Interpret the results of the MCA and draw at least the variable biplot of the analysis. You can also explore other plotting options for MCA. Comment on the output of the plots. (0-4 points)


```{r, ex5}
library(FactoMineR)
data("tea")
str(tea)
dim(tea)
summary(tea)
```
more 

```{r, ex5.1, fig.width=10, fig.height=15}
library(tidyr)
library(dplyr)
keep<- c("breakfast","tea.time","friends","frequency","Tea","sugar","sex","sophisticated")
my_tea <- dplyr::select(tea, one_of(keep))
gather(my_tea) %>% ggplot(aes(value)) + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + facet_wrap("key", scales = "free")
```
```{r, ex5.2, fig.width=10, fig.height=10}
mca_tea <- MCA(my_tea, graph=FALSE)
summary(mca_tea, nbelements=Inf, nbind=5)
```

```{r, ex5.3, fig.width=10, fig.height=10}
plot(mca_tea, invisible = c("ind"), habillage = "quali", sub = "MCA of tea dataset")

```






